<!DOCTYPE html>
<html lang="en"
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>learnPhaser</title>
    <script src="phaser/phaser.js"></script>
    <script src="js/boot.js"></script>
    <script src="js/loader.js"></script>

    <style>
        @font-face {
            font-family: 'fzhyt';
            src: url("res/活一体字体.TTF");
        }
    </style>
</head>
<body>
    <h1 style="font-family: fzhyt">LearnPhaser</h1>
    <div id="div_phaser" style="width: 1000px;height: 1000px;border: 1px solid red"></div>

    <script>
        var game = new Phaser.Game(400,400,Phaser.CANVAS,'div_phaser');

        var player;
        var cursors;
        var layer;
        var sprite;
        var sprite2;
        var inputHandler;

        function state() {
            this.init = function(){
                game.scale.pageAlignHorizontally = true;    //水平居中
                game.scale.pageAlignVertically = true;      //垂直居中


            },
            this.preload = function(){
                game.load.image('backgroud','res/backgroud.png');
                game.load.image('cat','res/cat.jpg');
                game.load.spritesheet('sprite', 'res/a1.png', 32, 32);
                game.load.bitmapFont('font','res/font.png','res/font.fnt')
                game.load.atlasXML('man','res/r.png','res/r.xml');

                game.load.tilemap('mario_map', 'res/mario.json',null,Phaser.Tilemap.TILED_JSON);
                game.load.image('mario','res/mario.png');
                game.load.image('player','res/player.png');//玩家
                game.load.audio('foo','res/music.mp3');

                game.load.audio('foo', ['res/music.mp3', 'res/music.wav']);

                game.load.audiosprite(key, urls, jsonURL?, jsonData?, autoDecode?);
            },
            this.create = function(){
                game.physics.startSystem(Phaser.Physics.ARCADE);
                sprite = game.add.sprite(10,10,'sprite');
                sprite2 = game.add.sprite(90,90,'cat');

                game.physics.enable(sprite, Phaser.Physics.ARCADE);
                sprite.inputEnabled = true;//开启输入事件
                sprite.input.enableDrag();

                game.physics.enable(sprite2, Phaser.Physics.ARCADE);

                sprite.body.collideWorldBounds = true;
                sprite2.body.collideWorldBounds = true;

                sprite.body.gravity.y = 100;
                sprite.body.bounce.y = 0.2;

                var group = game.add.group();
                group.enableBody = true;
                group.physicsBodyType = Phaser.Physics.ARCADE;
                group.setAll('body.bounce', new Phaser.Point(0.5, 0.5));//每个元素设置

                var sound = game.add.audio('music');
                // 播放标注的那段,标注位置,音量(0~1),循环,强制重新开始
                sound.play(marker, position, volume, loop, forceRestart);//播放
                sound.pause();//暂停
                sound.resume();//恢复
                sound.stop();//停止

                sound.fadeIn(duration, loop, marker);//淡入淡出时间,循环,标记那段
                sound.fadeOut(duration);//时间
                sound.fadeTo(duration, volume);//时间,制定音量(0~1)

                //事件
                sound.onPlay.add(function () {
                    alert("播放时");
                });
                sound.onPause.add(function () {});//暂停
                sound.onResume.add(function () {});//恢复
                sound.onStop.add(function () {});//停止
                sound.onFadeComplete.add(function () {});//淡入淡出完成
                sound.onMarkerComplete.add(function () {});//标记播放完
                sound.onLoop.add(function () {});//循环时
                sound.onMute.add(function () {});//静音时
            },
            this.update = function(){
                //碰撞有真实效果 update 里面调用
                game.physics.arcade.collide(sprite, sprite2)

            }
        }

        game.state.add('state1',state);
        game.state.start('state1');


    </script>
</body>
</html>